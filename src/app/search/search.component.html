<form (ngSubmit)="onSearch()" class="search-form" role="search" aria-label="Find a guide">
  <label class="location-wrapper">
    <span class="sr-only">Location</span>
    <input 
      name="location" 
      [(ngModel)]="location" 
      (input)="onLocationInput($event)"
      (keydown)="onLocationKeydown($event)"
      (blur)="closeSuggestions()"
      placeholder="Location (city or attraction)" 
      aria-label="Location"
      autocomplete="off" />
    
    <!-- Autosuggest dropdown -->
    <div class="suggestions-dropdown" *ngIf="showSuggestions && suggestions.length > 0">
      <div 
        *ngFor="let suggestion of suggestions; let i = index"
        class="suggestion-item"
        [class.selected]="i === selectedIndex"
        (mousedown)="selectSuggestion(suggestion)"
        role="option"
        [attr.aria-selected]="i === selectedIndex">
        <div class="suggestion-name">{{ suggestion.name }}</div>
        <div class="suggestion-meta">{{ suggestion.country }} â€¢ {{ suggestion.type }}</div>
      </div>
    </div>
    <div class="error-message" *ngIf="locationError">{{ locationError }}</div>
  </label>
  <label>
    <span class="sr-only">From Date</span>
    <input 
      type="date" 
      name="from" 
      [(ngModel)]="fromDate" 
      (change)="onFromDateChange()"
      [min]="minDate"
      aria-label="From date" />
    <div class="error-message" *ngIf="fromDateError">{{ fromDateError }}</div>
  </label>
  <label>
    <span class="sr-only">To Date</span>
    <input 
      type="date" 
      name="to" 
      [(ngModel)]="toDate" 
      (change)="onToDateChange()"
      [min]="fromDate || minDate"
      aria-label="To date" />
    <div class="error-message" *ngIf="toDateError">{{ toDateError }}</div>
  </label>
  <button type="submit" class="search-button" aria-label="Search for guides" [disabled]="isSearching">
    <span *ngIf="!isSearching">Search</span>
    <span *ngIf="isSearching">Searching...</span>
  </button>
</form>

<!-- Search Results Section -->
<div class="search-results-section" *ngIf="hasSearched">
  <div class="results-header">
    <h2 *ngIf="isSearching">
      Searching for attractions in {{ location }}...
    </h2>
    <h2 *ngIf="!isSearching && searchResults.length > 0">
      Found {{ searchResults.length }} attraction{{ searchResults.length === 1 ? '' : 's' }} in {{ location }}
    </h2>
    <h2 *ngIf="!isSearching && searchResults.length === 0">
      No attractions found for "{{ location }}"
    </h2>
    <p *ngIf="!isSearching && searchResults.length === 0" class="no-results-text">
      Try searching for a different location or check the spelling.
    </p>
  </div>
  
  <div class="results-grid" *ngIf="searchResults.length > 0 && !isSearching">
    <app-result-card 
      *ngFor="let attraction of searchResults" 
      [attraction]="attraction"
      [fromDate]="fromDate"
      [toDate]="toDate"
      (selectAttraction)="onSelectAttraction($event)">
    </app-result-card>
  </div>
  
  <div class="loading-spinner" *ngIf="isSearching">
    <div class="spinner"></div>
    <p>Loading results...</p>
  </div>
</div>
